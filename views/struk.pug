doctype html
html
  head
    title Struk - #{trx._id.toString().slice(-6).toUpperCase()}
    style.
      /* Pengaturan Dasar untuk Printer Thermal */
      * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Courier New', monospace; }
      
      body { 
        width: 58mm; 
        margin: 0 auto; 
        padding: 5px; 
        font-size: 11px; 
        color: #000;
      }

      .text-center { text-align: center; }
      .text-right { text-align: right; }
      .fw-bold { font-weight: bold; }
      
      .header-toko { margin-bottom: 10px; line-height: 1.2; }
      .header-toko strong { font-size: 14px; }
      
      .dashed-line { border-bottom: 1px dashed #000; margin: 5px 0; width: 100%; }
      
      .info-transaksi { font-size: 10px; margin-bottom: 5px; width: 100%; }
      .info-transaksi td { vertical-align: top; }

      .tabel-item { width: 100%; border-collapse: collapse; margin: 5px 0; }
      .tabel-item td { padding: 2px 0; vertical-align: top; }
      
      .total-section { width: 100%; margin-top: 5px; }
      .total-row { display: flex; justify-content: space-between; font-size: 12px; padding: 2px 0; }

      @media print {
        @page { margin: 0; }
        .no-print { display: none !important; }
        body { width: 100%; margin: 0; padding: 2mm; }
      }

      .logo-container { text-align: center; margin-bottom: 5px; }
      .logo-img { 
        width: 25mm;
        height: auto;
        filter: grayscale(100%) contrast(150%);
      }

  body
  
    //- .logo-container
    //-   img.logo-img(src="/images/titik.png" alt="Logo")
    .text-center.header-toko
      strong TITIK SERU!!!
      br
      | Malompo Nabire, Papua Tengah
      br
      | WA: 0821-8816-0867
    
    .dashed-line

    table.info-transaksi
      tr
        td(style="width: 25%") No
        td : #{trx._id.toString().slice(-6).toUpperCase()}
      tr
        td Tgl
        td : #{new Date(trx.tanggal).toLocaleString('id-ID', { dateStyle: 'short', timeStyle: 'short' }).replace(/\./g, ':')}
    
    .dashed-line

    table.tabel-item
      each item in trx.items
        tr
          td(colspan="2" style="text-transform: uppercase; font-weight: bold;")= item.nama
        tr
          td(style="padding-left: 5px; color: #333;") #{item.qty} x #{Number(item.harga).toLocaleString('id-ID')}
          td.text-right= (Number(item.qty) * Number(item.harga)).toLocaleString('id-ID')
    
    .dashed-line

    .total-section
      //- Baris Total
      .total-row.fw-bold
        span TOTAL
        span Rp#{Number(trx.totalBayar).toLocaleString('id-ID')}
      
      if trx.metode
        .total-row(style="font-size: 10px;")
          span Metode
          span= trx.metode
      
      .total-row(style="font-size: 10px;")
        span Bayar
        - let nominalBayar = Number(trx.tunai) || 0
        span Rp#{nominalBayar.toLocaleString('id-ID')}
      
      .total-row(style="font-size: 10px;")
        span Kembali
        - let nominalTotal = Number(trx.totalBayar) || 0
        - let kembalian = nominalBayar - nominalTotal
        span Rp#{(kembalian < 0 ? 0 : kembalian).toLocaleString('id-ID')}

    .dashed-line

    .text-center(style="margin-top: 5px;")
      p(style="font-weight: bold;") TERIMA KASIH
      p(style="font-size: 9px;") Simpan struk sebagai bukti bayar
    
    .no-print(style="margin-top: 30px; text-align: center;")
      button(onclick="window.print()" style="width: 100%; padding: 12px; background: #000; color: #fff; border: none; border-radius: 4px; font-weight: bold; cursor: pointer;") CETAK SEKARANG
      br
      a(href="/" style="display: inline-block; margin-top: 15px; color: #666; font-size: 11px; text-decoration: none;") â¬… Kembali ke Kasir

    script.
      window.onload = function() {
        window.print();
        window.onafterprint = function() {
          window.location.href = '/';
        };
      }